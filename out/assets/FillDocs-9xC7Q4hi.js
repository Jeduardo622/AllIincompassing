import{r as u,j as e,z as p}from"./vendor-CkTWaQD2.js";import{edgeInvoke as E}from"./edgeInvoke-B3GAnXlD.js";import{l as g}from"./reports-B0fjwS8-.js";import"./maps-DwSjqVUD.js";import"./supabase-BgfCgt6W.js";import"./dates-C30WUoI7.js";function v(l){if("downloadUrl"in l&&typeof l.downloadUrl=="string"&&l.downloadUrl.length>0)return{kind:"signed-url",url:l.downloadUrl,filename:l.filename};if("base64"in l&&typeof l.base64=="string"&&l.base64.length>0)return{kind:"base64",base64:l.base64,filename:l.filename,contentType:l.contentType};throw new Error("Fill docs response missing downloadUrl/base64")}const y={ER:"ER (Updated ER - IEHP)",FBA:"FBA (Updated FBA - IEHP)",PR:"PR (Updated PR - IEHP)"},N=[{key:"CLIENT_NAME",label:"Client name",placeholder:"Jane Doe"},{key:"CLIENT_DOB",label:"Client DOB",placeholder:"YYYY-MM-DD"},{key:"THERAPIST_NAME",label:"Therapist name",placeholder:"Therapist Full Name"},{key:"SERVICE_DATE",label:"Service date",placeholder:"YYYY-MM-DD"},{key:"START_TIME",label:"Start time",placeholder:"09:00 AM"},{key:"END_TIME",label:"End time",placeholder:"11:00 AM"},{key:"LOCATION",label:"Location",placeholder:"Clinic / Home / Telehealth"},{key:"SUMMARY",label:"Summary",placeholder:"Brief summary..."}];function A(l){const m=atob(l.base64),c=new Uint8Array(m.length);for(let a=0;a<m.length;a+=1)c[a]=m.charCodeAt(a);const d=new Blob([c],{type:l.contentType}),r=URL.createObjectURL(d);try{const a=document.createElement("a");a.href=r,a.download=l.filename,document.body.appendChild(a),a.click(),a.remove()}finally{URL.revokeObjectURL(r)}}function V(){const[l,m]=u.useState("ER"),[c,d]=u.useState(()=>N.map(s=>({key:s.key,value:""}))),[r,a]=u.useState(!1),h=u.useMemo(()=>{const s={};for(const t of c){const i=t.key.trim();i&&(s[i]=t.value??"")}return s},[c]),f=()=>d(s=>[...s,{key:"",value:""}]),D=s=>d(t=>t.filter((i,o)=>o!==s)),b=(s,t)=>d(i=>i.map((o,n)=>n===s?{...o,...t}:o)),x=async s=>{if(s.preventDefault(),!r){a(!0);try{const{data:t,error:i,status:o}=await E("fill-docs",{body:{template:l,fields:h}});if(i||!t?.success){const k=i?.message||`Failed to fill document (status ${o})`;p.error(k),g.error("FillDocs invoke failed",{error:i,context:{component:"FillDocs",operation:"edgeInvoke"},metadata:{status:o,template:l}});return}const n=v(t);n.kind==="signed-url"?window.location.assign(n.url):A({base64:n.base64,filename:n.filename,contentType:n.contentType}),p.success("Document generated")}catch(t){const i=t instanceof Error?t:new Error(String(t));p.error(i.message),g.error("FillDocs submit crashed",{error:i,context:{component:"FillDocs",operation:"handleSubmit"},metadata:{template:l}})}finally{a(!1)}}};return e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"mb-6",children:[e.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Fill Docs"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:118,columnNumber:9},this),e.jsxDEV("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["Uses the attached Word templates and replaces placeholders like ",e.jsxDEV("code",{children:"{{CLIENT_NAME}}"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:120,columnNumber:75},this),"."]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:119,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:117,columnNumber:7},this),e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow p-6",children:e.jsxDEV("form",{onSubmit:x,className:"space-y-6",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"template",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Template"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:127,columnNumber:13},this),e.jsxDEV("select",{id:"template",value:l,onChange:s=>m(s.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-dark dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",children:["ER","FBA","PR"].map(s=>e.jsxDEV("option",{value:s,children:y[s]},s,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:137,columnNumber:17},this))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:130,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:126,columnNumber:11},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Fields"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:146,columnNumber:15},this),e.jsxDEV("button",{type:"button",onClick:f,className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:"Add field"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:149,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:145,columnNumber:13},this),e.jsxDEV("div",{className:"mt-3 space-y-3",children:c.map((s,t)=>e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3",children:[e.jsxDEV("div",{className:"md:col-span-4",children:e.jsxDEV("input",{type:"text",value:s.key,onChange:i=>b(t,{key:i.target.value}),placeholder:"PLACEHOLDER_KEY (e.g., CLIENT_NAME)",className:"block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-dark dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:161,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:160,columnNumber:19},this),e.jsxDEV("div",{className:"md:col-span-7",children:e.jsxDEV("input",{type:"text",value:s.value,onChange:i=>b(t,{value:i.target.value}),placeholder:N.find(i=>i.key===s.key)?.placeholder??"Value",className:"block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-dark dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:170,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:169,columnNumber:19},this),e.jsxDEV("div",{className:"md:col-span-1 flex items-center",children:e.jsxDEV("button",{type:"button",onClick:()=>D(t),className:"text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300","aria-label":"Remove field",children:"Remove"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:179,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:178,columnNumber:19},this)]},`${s.key}-${t}`,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:159,columnNumber:17},this))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:157,columnNumber:13},this),e.jsxDEV("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:["Tip: placeholders in the Word docs must be literal text like ",e.jsxDEV("code",{children:"{{CLIENT_NAME}}"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:192,columnNumber:76},this),"."]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:191,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:144,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center gap-3",children:e.jsxDEV("button",{type:"submit",disabled:r,className:`px-4 py-2 rounded-md text-white ${r?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:r?"Generatingâ€¦":"Generate .docx"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:197,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:196,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:125,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:124,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/FillDocs.tsx",lineNumber:116,columnNumber:5},this)}export{V as default};
