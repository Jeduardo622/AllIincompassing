import{r as l,j as e,c as U,a as V,l as P,E as S,m as F}from"./vendor-CkTWaQD2.js";import{b as q,u as z,L as M}from"./router-BMrycgU4.js";import{u as R,s as m,t as p,l as b,a as E}from"./reports-B0fjwS8-.js";import"./maps-DwSjqVUD.js";import"./supabase-BgfCgt6W.js";import"./dates-C30WUoI7.js";function K(){const[i,N]=l.useState(""),[x,y]=l.useState(""),[g,C]=l.useState(!1),[f,a]=l.useState(""),[h,c]=l.useState(!1),[o,k]=l.useState(!1),[D,u]=l.useState(""),v=q(),d=z(),{signIn:L,resetPassword:A,user:w}=R();l.useEffect(()=>{const t=d.state?.message;if(t&&(u(t),d.state?.email&&N(d.state.email)),w){const s=d.state?.from?.pathname||"/";v(s,{replace:!0})}},[w,v,d]);const j=async t=>{if(t.preventDefault(),a(""),u(""),c(!0),!i||!x){a("Please enter both email and password"),m("Please enter both email and password"),c(!1);return}try{const{error:s}=await L(i,x);if(s){const n=p(s,"Login failed");b.error("Login error returned from sign-in",{error:n,metadata:{flow:"signIn",attemptedEmail:i}});let r=s.message;s.message.includes("Invalid login credentials")?r="Invalid email or password. Please check your credentials and try again.":s.message.includes("Email not confirmed")?r="Please check your email and click the confirmation link before signing in.":s.message.includes("Too many requests")&&(r="Too many login attempts. Please wait a moment and try again."),a(r),m(r);return}E("Successfully signed in!")}catch(s){const n=p(s,"Login failed");b.error("Login form submission threw an exception",{error:n,metadata:{flow:"signIn",attemptedEmail:i}});const r=s instanceof Error?s.message:"An unexpected error occurred";a(r),m(r)}finally{c(!1)}},I=async t=>{if(t.preventDefault(),a(""),u(""),!i){a("Please enter your email address"),m("Please enter your email address");return}c(!0);try{const{error:s}=await A(i);if(s){const n=p(s,"Password reset failed");b.error("Reset password request returned an error",{error:n,metadata:{flow:"resetPassword",attemptedEmail:i}}),a(s.message),m(s.message);return}u("Password reset email sent! Check your inbox for instructions."),E("Password reset email sent!"),k(!1)}catch(s){const n=p(s,"Password reset failed");b.error("Reset password request threw an exception",{error:n,metadata:{flow:"resetPassword",attemptedEmail:i}});const r=s instanceof Error?s.message:"An error occurred";a(r),m(r)}finally{c(!1)}};return e.jsxDEV("div",{className:"min-h-screen bg-gray-50 dark:bg-dark flex flex-col justify-center py-12 sm:px-6 lg:px-8 transition-colors",children:[e.jsxDEV("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsxDEV("div",{className:"flex justify-center",children:e.jsxDEV(U,{"aria-hidden":"true",className:"h-12 w-12 text-blue-600 dark:text-blue-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:157,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:156,columnNumber:9},this),e.jsxDEV("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:o?"Reset your password":"Sign in to AllIncompassing"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:159,columnNumber:9},this),!o&&e.jsxDEV("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400 transition-colors",children:["Or"," ",e.jsxDEV(M,{to:"/signup",className:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:"create a new account"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:165,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:163,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:155,columnNumber:7},this),e.jsxDEV("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter py-8 px-4 shadow sm:rounded-lg sm:px-10 transition-colors",children:[e.jsxDEV("form",{onSubmit:o?I:j,className:"space-y-6",children:[D&&e.jsxDEV("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-300 px-4 py-3 rounded-lg flex items-start",role:"alert",children:[e.jsxDEV(V,{className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:180,columnNumber:17},this),e.jsxDEV("span",{className:"block",children:D},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:181,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:179,columnNumber:15},this),f&&e.jsxDEV("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg flex items-start",role:"alert",children:[e.jsxDEV(P,{className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:187,columnNumber:17},this),e.jsxDEV("span",{className:"block",children:f},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:188,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:186,columnNumber:15},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email address"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:193,columnNumber:15},this),e.jsxDEV("div",{className:"mt-1",children:e.jsxDEV("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:i,onChange:t=>N(t.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark dark:text-white sm:text-sm"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:197,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:196,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:192,columnNumber:13},this),!o&&e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:212,columnNumber:17},this),e.jsxDEV("div",{className:"mt-1 relative",children:[e.jsxDEV("input",{id:"password",name:"password",type:g?"text":"password",autoComplete:"current-password",required:!0,value:x,onChange:t=>y(t.target.value),className:"appearance-none block w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-dark dark:text-white sm:text-sm"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:216,columnNumber:19},this),e.jsxDEV("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":g?"Hide password":"Show password",onClick:()=>C(!g),children:g?e.jsxDEV(S,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:233,columnNumber:23},this):e.jsxDEV(F,{className:"h-4 w-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:235,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:226,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:215,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:211,columnNumber:15},this),e.jsxDEV("div",{children:e.jsxDEV("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:h?e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:250,columnNumber:21},this),o?"Sending...":"Signing in..."]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:249,columnNumber:19},this):o?"Send reset email":"Sign in"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:243,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:242,columnNumber:13},this),e.jsxDEV("div",{className:"flex items-center justify-between",children:e.jsxDEV("button",{type:"button",onClick:()=>{k(!o),a(""),u("")},className:"text-sm font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:o?"Back to sign in":"Forgot your password?"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:260,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:259,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:177,columnNumber:11},this),!o&&e.jsxDEV("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsxDEV("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Test Accounts:"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:276,columnNumber:15},this),e.jsxDEV("div",{className:"space-y-1 text-sm text-blue-700 dark:text-blue-400",children:[e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"Client:"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:278,columnNumber:20},this)," client@test.com / password123"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:278,columnNumber:17},this),e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"Therapist:"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:279,columnNumber:20},this)," therapist@test.com / password123"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:279,columnNumber:17},this),e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"Admin:"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:280,columnNumber:20},this)," admin@test.com / password123"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:280,columnNumber:17},this),e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"Super Admin:"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:281,columnNumber:20},this)," superadmin@test.com / password123"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:281,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:277,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:275,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:176,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:175,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Login.tsx",lineNumber:154,columnNumber:5},this)}export{K as default};
