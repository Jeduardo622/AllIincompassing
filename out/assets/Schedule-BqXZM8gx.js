const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/edgeInvoke-B3GAnXlD.js","assets/reports-B0fjwS8-.js","assets/vendor-CkTWaQD2.js","assets/maps-DwSjqVUD.js","assets/supabase-BgfCgt6W.js","assets/dates-C30WUoI7.js"])))=>i.map(i=>d[i]);
import{j as e,d as le,K as Xe,a as Ns,r as n,N as fs,c as Ce,I as es,l as ve,A as Ae,U as pe,F as gs,O as xs,V as ss,W as ts,Y as We,Z as vs,R as ke,n as ks,_ as ye,$ as Ds,P as ys,a0 as As}from"./vendor-CkTWaQD2.js";import{_ as Ss}from"./supabase-BgfCgt6W.js";import{p as I,k as be,t as re,f as y,h as Ue,l as Ke,g as Cs,d as Se,m as Be,b as Es,c as Is}from"./dates-C30WUoI7.js";import{l as J,j as js,u as Us,t as he,s as Me,k as Qe,m as Ms,n as Vs,o as ws,a as Ye,f as _s}from"./reports-B0fjwS8-.js";import{g as Ts}from"./scheduling-BoBsSypz.js";import{e as Fs}from"./maps-DwSjqVUD.js";import{c as Os}from"./sessionCancellation-Cpqlzbyp.js";import{u as $s}from"./organization-IJZMqQph.js";async function Hs(i,l,b,r,f,o,c,u={}){const t=[],x=new Set,{excludeSessionId:g,timeZone:k="UTC"}=u,a=v=>/[zZ]|[+-]\d{2}:?\d{2}$/.test(v),p=a(i)?I(i):be(i,k),N=a(l)?I(l):be(l,k);if(Number.isNaN(p.getTime())||Number.isNaN(N.getTime()))return t;const A=re(p,k),$=re(N,k),j=v=>v.getHours()*60+v.getMinutes(),V=(v,E)=>{if(typeof v!="string")return null;const[_,ie="0"]=v.split(":"),z=Number.parseInt(_,10),ee=Number.parseInt(ie,10);if(Number.isNaN(z)||Number.isNaN(ee))return null;const R=new Date(E);return R.setHours(z,ee,0,0),j(R)},O=j(A),w=j($),m=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][(v=>v.getDay())(A)],C=o.availability_hours[m];if(C&&C.start&&C.end){const v=V(C.start,A),E=V(C.end,A);(v===null||E===null||O<v||w>E)&&(x.has("therapist_unavailable")||(t.push({type:"therapist_unavailable",message:`Therapist ${o.full_name} is not available during this time`}),x.add("therapist_unavailable")))}else x.has("therapist_unavailable")||(t.push({type:"therapist_unavailable",message:`Therapist ${o.full_name} is not available on ${y(A,"EEEE")}s`}),x.add("therapist_unavailable"));if(x.has("therapist_unavailable"))return t;const S=c.availability_hours[m];if(S&&S.start&&S.end){const v=V(S.start,A),E=V(S.end,A);(v===null||E===null||O<v||w>E)&&(x.has("client_unavailable")||(t.push({type:"client_unavailable",message:`Client ${c.full_name} is not available during this time`}),x.add("client_unavailable")))}else x.has("client_unavailable")||(t.push({type:"client_unavailable",message:`Client ${c.full_name} is not available on ${y(A,"EEEE")}s`}),x.add("client_unavailable"));if(x.has("client_unavailable"))return t;const T=f.filter(v=>{if(g&&v.id===g)return!1;const E=I(v.start_time),_=I(v.end_time);return(v.therapist_id===b||v.client_id===r)&&(Ue(p,{start:E,end:_})||Ue(N,{start:E,end:_})||Ue(E,{start:p,end:N}))});if(T.length>0&&!x.has("session_overlap")){const v=T[0],E=re(I(v.start_time),k),_=re(I(v.end_time),k);t.push({type:"session_overlap",message:`Overlaps with existing session from ${y(E,"h:mm a")} to ${y(_,"h:mm a")}`}),x.add("session_overlap")}return t}async function Rs(i,l,b,r,f,o,c,u,t={}){const{excludeSessionId:x,timeZone:g="UTC"}=t;try{const{edgeInvoke:k}=await Ss(async()=>{const{edgeInvoke:A}=await import("./edgeInvoke-B3GAnXlD.js");return{edgeInvoke:A}},__vite__mapDeps([0,1,2,3,4,5])),{data:a,error:p,status:N}=await k("suggest-alternative-times",{body:{startTime:i,endTime:l,therapistId:b,clientId:r,conflicts:u,therapist:o,client:c,existingSessions:f,excludeSessionId:x,timeZone:g}});return p?(console.error("Error suggesting alternative times:",{message:p.message,status:N}),[]):a?.alternatives||[]}catch(k){return console.error("Error suggesting alternative times:",k),[]}}function Ls({alternatives:i,isLoading:l,onSelectTime:b}){const r=[...i].sort((o,c)=>c.score-o.score),f=(o,c)=>{const u=typeof o=="string"&&o.length>=16?o.slice(11,16):y(I(o),"HH:mm"),t=typeof c=="string"&&c.length>=16?c.slice(11,16):y(I(c),"HH:mm");return`${u} - ${t}`};return e.jsxDEV("div",{className:"space-y-3 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg",children:[e.jsxDEV("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-300 flex items-center",children:[e.jsxDEV(le,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:31,columnNumber:9},this),"Alternative Times"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:30,columnNumber:7},this),e.jsxDEV("div",{className:"space-y-2",children:l?e.jsxDEV("div",{className:"flex items-center justify-center p-4",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-3"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:38,columnNumber:13},this),e.jsxDEV("p",{className:"text-blue-600 dark:text-blue-400",children:"Finding alternative times..."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:39,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:37,columnNumber:11},this):r.length===0?e.jsxDEV("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/10 rounded-lg",children:e.jsxDEV("p",{className:"text-amber-600 dark:text-amber-400 text-sm",children:"No alternative times could be found. Try adjusting the date or participants."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:43,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:42,columnNumber:11},this):r.map((o,c)=>e.jsxDEV("button",{type:"button",className:"text-left w-full bg-white dark:bg-dark-lighter rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow border border-blue-100 dark:border-blue-900/30 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":f(o.startTime,o.endTime),onClick:()=>b(o.startTime,o.endTime),children:[e.jsxDEV("div",{className:"flex justify-between items-center",children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 mr-3",children:c+1},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:57,columnNumber:17},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"font-medium text-gray-900 dark:text-white flex items-center",children:[y(I(o.startTime),"h:mm a"),e.jsxDEV(Xe,{className:"w-3 h-3 mx-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:63,columnNumber:21},this),y(I(o.endTime),"h:mm a")]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:61,columnNumber:19},this),e.jsxDEV("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:y(I(o.startTime),"EEEE, MMMM d, yyyy")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:66,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:60,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:56,columnNumber:15},this),e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-12 h-12 relative mr-2",children:[e.jsxDEV("svg",{viewBox:"0 0 36 36",className:"w-12 h-12 transform -rotate-90",children:[e.jsxDEV("path",{d:`M18 2.0845
                        a 15.9155 15.9155 0 0 1 0 31.831
                        a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:"#E2E8F0",strokeWidth:"3",className:"dark:stroke-gray-700"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:75,columnNumber:21},this),e.jsxDEV("path",{d:`M18 2.0845
                        a 15.9155 15.9155 0 0 1 0 31.831
                        a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeDasharray:`${o.score*100}, 100`,className:"dark:stroke-blue-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:84,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:74,columnNumber:19},this),e.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center text-sm font-medium text-blue-600 dark:text-blue-400",children:[Math.round(o.score*100),"%"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:95,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:73,columnNumber:17},this),e.jsxDEV("button",{className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-full",onClick:u=>{u.stopPropagation(),b(o.startTime,o.endTime)},children:e.jsxDEV(Ns,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:107,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:100,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:72,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:55,columnNumber:13},this),e.jsxDEV("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300 pl-11",children:o.reason},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:112,columnNumber:13},this)]},c,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:48,columnNumber:11},this))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:35,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AlternativeTimes.tsx",lineNumber:29,columnNumber:5},this)}function Ge({isOpen:i,onClose:l,onSubmit:b,session:r,selectedDate:f,selectedTime:o,therapists:c,clients:u,existingSessions:t,timeZone:x,defaultTherapistId:g,defaultClientId:k,retryHint:a,onRetryHintDismiss:p}){const[N,A]=n.useState([]),[$,j]=n.useState([]),[V,O]=n.useState(!1),w=n.useMemo(()=>{if(x&&x.length>0)return x;try{return Intl.DateTimeFormat().resolvedOptions().timeZone??"UTC"}catch(h){return J.warn("Unable to resolve user timezone",{error:h,context:{component:"SessionModal",operation:"resolveTimeZone"}}),"UTC"}},[x]),K=h=>{if(!h)return"";try{const U=typeof h=="string"?I(h):new Date(h);if(Number.isNaN(U.getTime()))return"";const P=re(U,w);return y(P,"yyyy-MM-dd'T'HH:mm")}catch(U){return J.error("Failed to format local input",{error:U,context:{component:"SessionModal",operation:"formatLocalInput"}}),""}},B=h=>{if(!h)return"";try{return be(h,w).toISOString()}catch(U){return J.error("Failed to convert local time to UTC",{error:U,context:{component:"SessionModal",operation:"toUtcIsoString"}}),""}},m=h=>{if(!h)return"";const U=I(h),P=Cs(U,60);return y(P,"yyyy-MM-dd'T'HH:mm")},C=()=>f&&o?`${y(f,"yyyy-MM-dd")}T${o}`:r?.start_time?K(r.start_time):"",{register:S,handleSubmit:T,watch:v,setValue:E,formState:{errors:_,isSubmitting:ie}}=fs({defaultValues:{therapist_id:r?.therapist_id||g||"",client_id:r?.client_id||k||"",start_time:C(),end_time:r?.end_time?K(r.end_time):f&&o?m(`${y(f,"yyyy-MM-dd")}T${o}`):"",notes:r?.notes||"",status:r?.status||"scheduled"}}),z=v("start_time"),ee=v("end_time"),R=v("therapist_id"),L=v("client_id"),ce=c.find(h=>h.id===R),oe=u.find(h=>h.id===L);n.useEffect(()=>{r?.therapist_id?E("therapist_id",r.therapist_id):g&&E("therapist_id",g)},[r?.therapist_id,g,E]),n.useEffect(()=>{r?.client_id?E("client_id",r.client_id):k&&E("client_id",k)},[r?.client_id,k,E]);const Ne=n.useRef({startTime:z,therapistId:R,clientId:L});n.useEffect(()=>{if(!p){Ne.current={startTime:z,therapistId:R,clientId:L};return}const h=Ne.current;(h.startTime!==z||h.therapistId!==R||h.clientId!==L)&&p(),Ne.current={startTime:z,therapistId:R,clientId:L}},[z,R,L,p]),n.useEffect(()=>{if(z&&R&&L){const h=be(z,w),U=Ke(h,1),P=re(U,w);E("end_time",y(P,"yyyy-MM-dd'T'HH:mm"))}},[z,R,L,w,E]),n.useEffect(()=>{(async()=>{if(z&&ee&&R&&L){const U=c.find(H=>H.id===R),P=u.find(H=>H.id===L);if(U&&P){const H=B(z),ae=B(ee);let X=await Hs(H,ae,R,L,t,U,P,{excludeSessionId:r?.id,timeZone:w});if(X.length===0)try{const Q=z,se=Q?.slice(0,10),ge=Q?.slice(11,16),ne=t.find(me=>{if(me.therapist_id!==R&&me.client_id!==L)return!1;const Y=me.start_time??"",Ee=typeof Y=="string"&&Y.length>=10?Y.slice(0,10):"",F=typeof Y=="string"&&Y.length>=16?Y.slice(11,16):"";return Ee===se&&F===ge});if(ne){const me=I(ne.start_time),Y=I(ne.end_time);X=[{type:"session_overlap",message:`Overlaps with existing session from ${y(me,"h:mm a")} to ${y(Y,"h:mm a")}`}]}}catch{}if(A(X),X.length>0){O(!0);try{const Q=await Rs(H,ae,R,L,t,U,P,X,{excludeSessionId:r?.id,timeZone:w});j(Q)}catch(Q){J.error("Failed to suggest alternative times",{error:Q,context:{component:"SessionModal",operation:"suggestAlternativeTimes"}}),j([])}finally{O(!1)}}else j([])}}})()},[z,ee,R,L,c,u,t,r?.id,w]);const de=async h=>{if(!(N.length>0&&!window.confirm("There are scheduling conflicts. Do you want to proceed anyway?")))try{const U={...h,start_time:x?B(h.start_time):h.start_time,end_time:x?B(h.end_time):h.end_time};await b(U)}catch(U){J.error("Failed to submit session",{error:U,context:{component:"SessionModal",operation:"handleFormSubmit"}});return}},ue=(h,U)=>{const P=h.target.value;if(!P){E(U,"");return}const H=be(P,w),ae=H.getUTCMinutes(),X=Math.round(ae/15)*15,Q=new Date(H);Q.setUTCMinutes(X%60,0,0),X>=60&&Q.setUTCHours(H.getUTCHours()+Math.floor(X/60));const se=re(Q,w);if(E(U,y(se,"yyyy-MM-dd'T'HH:mm")),U==="start_time"){const ge=Ke(Q,1),ne=re(ge,w);E("end_time",y(ne,"yyyy-MM-dd'T'HH:mm"))}},fe=(h,U)=>{const P=H=>K(H);E("start_time",P(h)),E("end_time",P(U))};return i?e.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true",children:e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[e.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[e.jsxDEV(Ce,{className:"w-6 h-6 mr-2 text-blue-600"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:357,columnNumber:13},this),r?"Edit Session":"New Session"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:356,columnNumber:11},this),e.jsxDEV("button",{onClick:l,className:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:e.jsxDEV(es,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:364,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:360,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:355,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxDEV("form",{id:"session-form",onSubmit:T(de),className:"space-y-6",children:[a&&e.jsxDEV("div",{className:"flex items-start gap-3 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-900/40 dark:bg-blue-900/20",children:[e.jsxDEV(ve,{className:"w-5 h-5 text-blue-500 dark:text-blue-300 mt-0.5 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:373,columnNumber:17},this),e.jsxDEV("div",{className:"text-sm text-blue-800 dark:text-blue-100 space-y-2",children:[e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-medium",children:"Session not saved"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:376,columnNumber:21},this),e.jsxDEV("p",{className:"mt-1",children:a},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:377,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:375,columnNumber:19},this),p&&e.jsxDEV("button",{type:"button",onClick:p,className:"text-xs font-semibold text-blue-600 hover:text-blue-500 dark:text-blue-300 dark:hover:text-blue-200",children:"Dismiss"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:380,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:374,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:372,columnNumber:15},this),N.length>0&&e.jsxDEV("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-900/30 rounded-lg p-4",children:[e.jsxDEV("div",{className:"flex items-center mb-2",children:[e.jsxDEV(Ae,{className:"w-5 h-5 text-amber-500 dark:text-amber-400 mr-2 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:394,columnNumber:19},this),e.jsxDEV("h3",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Scheduling Conflicts"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:395,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:393,columnNumber:17},this),e.jsxDEV("ul",{className:"space-y-2 text-sm text-amber-700 dark:text-amber-300",children:N.map((h,U)=>e.jsxDEV("li",{className:"flex items-start",children:[e.jsxDEV(ve,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:402,columnNumber:23},this),e.jsxDEV("span",{children:h.message},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:403,columnNumber:23},this)]},U,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:401,columnNumber:21},this))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:399,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:392,columnNumber:15},this),e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"therapist-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Therapist"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:412,columnNumber:17},this),e.jsxDEV("select",{id:"therapist-select",...S("therapist_id",{required:"Therapist is required"}),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",children:[e.jsxDEV("option",{value:"",children:"Select a therapist"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:423,columnNumber:19},this),c.map(h=>e.jsxDEV("option",{value:h.id,children:h.full_name},h.id,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:425,columnNumber:21},this))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:418,columnNumber:17},this),_.therapist_id&&e.jsxDEV("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:_.therapist_id.message},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:431,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:411,columnNumber:15},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"client-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:436,columnNumber:17},this),e.jsxDEV("select",{id:"client-select",...S("client_id",{required:"Client is required"}),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",children:[e.jsxDEV("option",{value:"",children:"Select a client"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:447,columnNumber:19},this),u.map(h=>e.jsxDEV("option",{value:h.id,children:h.full_name},h.id,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:449,columnNumber:21},this))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:442,columnNumber:17},this),_.client_id&&e.jsxDEV("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:_.client_id.message},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:455,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:435,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:410,columnNumber:13},this),ce&&oe&&e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsxDEV(pe,{className:"w-4 h-4 mr-2 text-blue-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:464,columnNumber:21},this),e.jsxDEV("span",{children:ce.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:465,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:463,columnNumber:19},this),e.jsxDEV("div",{className:"mt-1 text-xs text-gray-500",children:ce.service_type.join(", ")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:467,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:462,columnNumber:17},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsxDEV(pe,{className:"w-4 h-4 mr-2 text-green-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:473,columnNumber:21},this),e.jsxDEV("span",{children:oe.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:474,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:472,columnNumber:19},this),e.jsxDEV("div",{className:"mt-1 text-xs text-gray-500",children:oe.service_preference.join(", ")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:476,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:471,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:461,columnNumber:15},this),e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"start-time-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Time"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:485,columnNumber:17},this),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:492,columnNumber:19},this),e.jsxDEV("input",{type:"datetime-local",id:"start-time-input",...S("start_time",{required:"Start time is required"}),className:"w-full pl-10 rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",onChange:h=>ue(h,"start_time"),step:"900"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:493,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:491,columnNumber:17},this),_.start_time&&e.jsxDEV("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:_.start_time.message},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:503,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:484,columnNumber:15},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"end-time-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Time"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:508,columnNumber:17},this),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:515,columnNumber:19},this),e.jsxDEV("input",{type:"datetime-local",id:"end-time-input",...S("end_time",{required:"End time is required"}),className:"w-full pl-10 rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",onChange:h=>ue(h,"end_time"),step:"900"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:516,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:514,columnNumber:17},this),_.end_time&&e.jsxDEV("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:_.end_time.message},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:526,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:507,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:483,columnNumber:13},this),N.length>0&&e.jsxDEV(Ls,{alternatives:$,isLoading:V,onSelectTime:fe},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:533,columnNumber:15},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"status-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:541,columnNumber:15},this),e.jsxDEV("select",{id:"status-select",...S("status"),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",children:[e.jsxDEV("option",{value:"scheduled",children:"Scheduled"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:552,columnNumber:17},this),e.jsxDEV("option",{value:"completed",children:"Completed"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:553,columnNumber:17},this),e.jsxDEV("option",{value:"cancelled",children:"Cancelled"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:554,columnNumber:17},this),e.jsxDEV("option",{value:"no-show",children:"No Show"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:555,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:547,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:540,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"notes-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsxDEV(gs,{className:"w-4 h-4 inline mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:564,columnNumber:17},this),"Notes"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:560,columnNumber:15},this),e.jsxDEV("textarea",{id:"notes-input",...S("notes"),rows:3,className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",placeholder:"Add any session notes here..."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:567,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:559,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:370,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:369,columnNumber:9},this),e.jsxDEV("div",{className:"border-t dark:border-gray-700 p-4",children:e.jsxDEV("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3",children:[e.jsxDEV("button",{type:"button",onClick:l,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-dark border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:581,columnNumber:13},this),e.jsxDEV("button",{type:"submit",form:"session-form",disabled:ie,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:ie?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:596,columnNumber:19},this),"Saving..."]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:595,columnNumber:17},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(xs,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:601,columnNumber:19},this),r?"Update Session":"Create Session"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:600,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:588,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:580,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:579,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:353,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionModal.tsx",lineNumber:352,columnNumber:5},this):null}function Ps({isOpen:i,onClose:l,onSchedule:b,therapists:r,clients:f,existingSessions:o}){const[c,u]=n.useState(new Date().toISOString().split("T")[0]),[t,x]=n.useState(1),[g,k]=n.useState(!1),[a,p]=n.useState({slots:[],cappedClients:[]}),[N,A]=n.useState(0),$=5,j=()=>{const m=I(c),C=Se(m,t*7-1),S=Ts(r,f,o,m,C);p(S),A(0)},V=async()=>{try{k(!0);const m=a.slots.map(C=>({therapist_id:C.therapist.id,client_id:C.client.id,start_time:C.startTime,end_time:C.endTime,status:"scheduled"}));await b(m),l()}catch(m){J.error("Failed to auto schedule sessions",{error:m,context:{component:"AutoScheduleModal",operation:"handleSchedule"}})}finally{k(!1)}},O=m=>{if(!m.therapist.latitude||!m.therapist.longitude||!m.client.latitude||!m.client.longitude)return null;const C=Fs.getDistance({latitude:m.therapist.latitude,longitude:m.therapist.longitude},{latitude:m.client.latitude,longitude:m.client.longitude})/1e3;let S=C/30*60;const T=new Date(m.startTime).getHours(),v=T>=8&&T<=9||T>=16&&T<=18;return v&&(S*=1.5),{distance:Math.round(C*10)/10,travelTime:Math.round(S),isRushHour:v}},w=Math.max(1,Math.ceil(a.slots.length/$)),K=a.slots.slice(N*$,(N+1)*$),B=m=>{if(m<=0)return"No remaining hours";const C=m/60;return C>=1?`${Number.isInteger(C)?C.toFixed(0):C.toFixed(1)}h remaining`:`${C.toFixed(2)}h remaining`};return i?e.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[e.jsxDEV("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Auto Schedule Sessions"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:138,columnNumber:11},this),e.jsxDEV("button",{onClick:l,className:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400",children:e.jsxDEV(es,{className:"h-6 w-6"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:145,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:141,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:137,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"auto-start-date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:154,columnNumber:15},this),e.jsxDEV("input",{id:"auto-start-date",type:"date",value:c,onChange:m=>u(m.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:157,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:153,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"auto-num-weeks",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Number of Weeks"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:166,columnNumber:15},this),e.jsxDEV("input",{id:"auto-num-weeks",type:"number",min:"1",max:"12",value:t,onChange:m=>x(parseInt(m.target.value,10)),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:169,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:165,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:152,columnNumber:11},this),e.jsxDEV("div",{className:"flex justify-center",children:e.jsxDEV("button",{onClick:j,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Generate Preview"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:182,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:181,columnNumber:11},this),a.cappedClients.length>0&&e.jsxDEV("div",{className:"rounded-md border border-amber-200 bg-amber-50 p-3 text-sm text-amber-800 dark:border-amber-700 dark:bg-dark/40 dark:text-amber-200",children:e.jsxDEV("div",{className:"flex items-start space-x-2",children:[e.jsxDEV(ve,{className:"mt-0.5 h-4 w-4 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:194,columnNumber:17},this),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-medium",children:"Some clients are at their monthly limits and were skipped."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:196,columnNumber:19},this),e.jsxDEV("ul",{className:"mt-2 space-y-1",children:a.cappedClients.map(({client:m,remainingMinutes:C})=>e.jsxDEV("li",{className:"flex items-center justify-between",children:[e.jsxDEV("span",{className:"font-medium text-amber-900 dark:text-amber-100",children:m.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:200,columnNumber:25},this),e.jsxDEV("span",{className:"text-xs text-amber-700 dark:text-amber-200/80",children:B(C)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:203,columnNumber:25},this)]},m.id,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:199,columnNumber:23},this))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:197,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:195,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:193,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:192,columnNumber:13},this),a.slots.length>0?e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Proposed Schedule (",a.slots.length," sessions)"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:218,columnNumber:17},this),e.jsxDEV("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxDEV("button",{onClick:()=>A(m=>Math.max(0,m-1)),disabled:N===0,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 disabled:opacity-50",children:e.jsxDEV(ss,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:227,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:222,columnNumber:19},this),e.jsxDEV("span",{children:["Page ",N+1," of ",w]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:229,columnNumber:19},this),e.jsxDEV("button",{onClick:()=>A(m=>Math.min(w-1,m+1)),disabled:N===w-1,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 disabled:opacity-50",children:e.jsxDEV(ts,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:237,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:232,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:221,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:217,columnNumber:15},this),e.jsxDEV("div",{className:"space-y-4",children:K.map((m,C)=>{const S=O(m),T=new Date(m.startTime).getHours(),v=T>=8&&T<=9||T>=16&&T<=18;return e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow p-4",children:[e.jsxDEV("div",{className:"block sm:hidden space-y-3",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.jsxDEV(Ce,{className:"w-4 h-4 inline mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:257,columnNumber:29},this),y(I(m.startTime),"EEE, MMM d")]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:256,columnNumber:27},this),e.jsxDEV("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsxDEV(le,{className:"w-4 h-4 inline mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:261,columnNumber:29},this),y(I(m.startTime),"h:mm a")]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:260,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:255,columnNumber:25},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(pe,{className:"w-4 h-4 mr-2 text-blue-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:268,columnNumber:29},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"font-medium",children:m.therapist.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:270,columnNumber:31},this),e.jsxDEV("div",{className:"text-xs text-gray-500",children:m.therapist.service_type.join(", ")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:271,columnNumber:31},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:269,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:267,columnNumber:27},this),S&&e.jsxDEV("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[e.jsxDEV(We,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:277,columnNumber:31},this),S.distance,"km (",S.travelTime,"min)",v&&e.jsxDEV(ve,{className:"w-3 h-3 ml-1 text-amber-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:280,columnNumber:33},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:276,columnNumber:29},this),e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(pe,{className:"w-4 h-4 mr-2 text-green-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:286,columnNumber:29},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"font-medium",children:m.client.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:288,columnNumber:31},this),e.jsxDEV("div",{className:"text-xs text-gray-500",children:m.client.service_preference.join(", ")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:289,columnNumber:31},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:287,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:285,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:266,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:254,columnNumber:23},this),e.jsxDEV("div",{className:"hidden sm:block",children:[e.jsxDEV("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-sm font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsxDEV(pe,{className:"w-4 h-4 mr-2 text-blue-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:300,columnNumber:31},this),m.therapist.full_name]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:299,columnNumber:29},this),e.jsxDEV("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:m.therapist.service_type.join(", ")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:303,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:298,columnNumber:27},this),e.jsxDEV("div",{className:"text-center",children:e.jsxDEV("div",{className:"flex items-center justify-center text-gray-500 dark:text-gray-400",children:[e.jsxDEV(Xe,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:310,columnNumber:31},this),S&&e.jsxDEV("div",{className:"ml-2 flex items-center text-xs",children:[e.jsxDEV(We,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:313,columnNumber:35},this),S.distance,"km (",S.travelTime,"min)",v&&e.jsxDEV(ve,{className:"w-3 h-3 ml-1 text-amber-500",title:"Rush hour"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:316,columnNumber:37},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:312,columnNumber:33},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:309,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:308,columnNumber:27},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-sm font-medium text-gray-900 dark:text-white flex items-center justify-end",children:[e.jsxDEV(pe,{className:"w-4 h-4 mr-2 text-green-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:325,columnNumber:31},this),m.client.full_name]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:324,columnNumber:29},this),e.jsxDEV("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-right",children:m.client.service_preference.join(", ")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:328,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:323,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:297,columnNumber:25},this),e.jsxDEV("div",{className:"mt-2 flex items-center justify-between text-sm",children:[e.jsxDEV("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsxDEV(Ce,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:336,columnNumber:29},this),y(I(m.startTime),"EEEE, MMMM d")]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:335,columnNumber:27},this),e.jsxDEV("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsxDEV(le,{className:"w-4 h-4 mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:340,columnNumber:29},this),y(I(m.startTime),"h:mm a")," -",y(I(m.endTime),"h:mm a")]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:339,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:334,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:296,columnNumber:23},this),e.jsxDEV("div",{className:"mt-2 flex items-center",children:[e.jsxDEV("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsxDEV("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:`${m.score*100}%`}},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:350,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:349,columnNumber:25},this),e.jsxDEV("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400",children:[Math.round(m.score*100),"% match"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:355,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:348,columnNumber:23},this)]},C,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:249,columnNumber:21},this)})},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:242,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:216,columnNumber:13},this):e.jsxDEV("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:a.cappedClients.length>0?"All eligible clients are already at their authorized limits for the selected range.":"Generate a preview to see proposed sessions"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:365,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:150,columnNumber:9},this),a.slots.length>0&&e.jsxDEV("div",{className:"border-t dark:border-gray-700 p-4",children:e.jsxDEV("div",{className:"flex justify-end space-x-3",children:[e.jsxDEV("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-dark border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:377,columnNumber:15},this),e.jsxDEV("button",{onClick:V,disabled:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Scheduling...":"Schedule All Sessions"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:383,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:376,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:375,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:135,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AutoScheduleModal.tsx",lineNumber:134,columnNumber:5},this):null}function is({therapists:i,clients:l,selectedDate:b,timeSlots:r}){const f=y(b,"EEEE").toLowerCase(),o=n.useMemo(()=>{const c=new Map;return r.forEach(u=>{const[t,x]=u.split(":").map(Number),g=t*60+x,k={therapists:new Set,clients:new Set};i.forEach(a=>{const p=a.availability_hours?.[f];if(p?.start&&p?.end){const[N,A]=p.start.split(":").map(Number),[$,j]=p.end.split(":").map(Number),V=N*60+A,O=$*60+j;g>=V&&g<O&&k.therapists.add(a.id)}}),l.forEach(a=>{const p=a.availability_hours?.[f];if(p?.start&&p?.end){const[N,A]=p.start.split(":").map(Number),[$,j]=p.end.split(":").map(Number),V=N*60+A,O=$*60+j;g>=V&&g<O&&k.clients.add(a.id)}}),c.set(u,k)}),c},[i,l,f,r]);return e.jsxDEV("div",{className:"absolute inset-0 pointer-events-none",children:r.map(c=>e.jsxDEV("div",{className:"h-20 border-b border-r relative",children:e.jsxDEV("div",{className:"absolute inset-0 flex",children:[e.jsxDEV("div",{className:"flex-1 flex",children:i.map(u=>{const t=o.get(c)?.therapists.has(u.id);return e.jsxDEV("div",{className:`flex-1 ${t?"bg-green-50":"bg-red-50"} opacity-20`,title:`${u.full_name} ${t?"Available":"Unavailable"} at ${c}`},u.id,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:76,columnNumber:19},this)})},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:72,columnNumber:13},this),e.jsxDEV("div",{className:"flex-1 flex",children:l.map(u=>{const t=o.get(c)?.clients.has(u.id);return e.jsxDEV("div",{className:`flex-1 ${t?"bg-blue-50":"bg-gray-50"} opacity-20`,title:`${u.full_name} ${t?"Available":"Unavailable"} at ${c}`},u.id,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:96,columnNumber:19},this)})},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:92,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:70,columnNumber:11},this)},c,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:69,columnNumber:9},this))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/AvailabilityOverlay.tsx",lineNumber:67,columnNumber:5},this)}function zs({therapists:i,clients:l,selectedTherapist:b,selectedClient:r,onTherapistChange:f,onClientChange:o,scopedTherapistId:c,scopedClientId:u}){const t=!!(c&&b===c),x=!!(u&&r===u);return e.jsxDEV("div",{className:"flex items-center space-x-4 bg-white dark:bg-dark-lighter p-4 rounded-lg shadow mb-6",children:[e.jsxDEV(vs,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 flex-shrink-0"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:31,columnNumber:7},this),e.jsxDEV("div",{className:"flex-1 flex flex-col sm:flex-row gap-4",children:[e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("label",{htmlFor:"therapist-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Therapist"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:34,columnNumber:11},this),e.jsxDEV("select",{id:"therapist-filter",value:b||"",onChange:g=>f(g.target.value||null),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",children:[e.jsxDEV("option",{value:"",children:["All Therapists (",i.length,")"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:43,columnNumber:13},this),i.map(g=>e.jsxDEV("option",{value:g.id,children:[g.full_name," - ",(g.service_type??[]).join(", ")]},g.id,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:45,columnNumber:15},this))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:37,columnNumber:11},this),t&&e.jsxDEV("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-300",children:'Showing sessions for your therapist account. Select "All Therapists" to view the full organization.'},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:51,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:33,columnNumber:9},this),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("label",{htmlFor:"client-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:58,columnNumber:11},this),e.jsxDEV("select",{id:"client-filter",value:r||"",onChange:g=>o(g.target.value||null),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",children:[e.jsxDEV("option",{value:"",children:["All Clients (",l.length,")"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:67,columnNumber:13},this),l.map(g=>e.jsxDEV("option",{value:g.id,children:[g.full_name," - ",(g.service_preference??[]).join(", ")]},g.id,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:69,columnNumber:15},this))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:61,columnNumber:11},this),x&&e.jsxDEV("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-300",children:"Client filter applied automatically from the current context."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:75,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:57,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:32,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SessionFilters.tsx",lineNumber:30,columnNumber:5},this)}const xe=40,Ve=600;function Zs({therapists:i,clients:l,selectedDate:b,onTimeSlotClick:r}){const f=n.useRef(null),[o,c]=n.useState(0),u=n.useMemo(()=>{const a=[];for(let p=8;p<18;p++)for(let N=0;N<60;N+=15){const A=p.toString().padStart(2,"0"),$=N.toString().padStart(2,"0");a.push(`${A}:${$}`)}return a},[]),t=js(u,xe,Ve),x=y(b,"EEEE").toLowerCase(),g=n.useMemo(()=>{const a=new Map;return u.forEach(p=>{const[N,A]=p.split(":").map(Number),$={therapists:new Set,clients:new Set};i.forEach(j=>{const V=j.availability_hours?.[x];if(V?.start&&V?.end){const[O,w]=V.start.split(":").map(Number),[K,B]=V.end.split(":").map(Number),m=O*60+w,C=K*60+B,S=N*60+A;S>=m&&S<C&&$.therapists.add(j.id)}}),l.forEach(j=>{const V=j.availability_hours?.[x];if(V?.start&&V?.end){const[O,w]=V.start.split(":").map(Number),[K,B]=V.end.split(":").map(Number),m=O*60+w,C=K*60+B,S=N*60+A;S>=m&&S<C&&$.clients.add(j.id)}}),a.set(p,$)}),a},[i,l,x,u]);n.useEffect(()=>{const a=f.current;if(!a)return;const p=N=>{const A=N.currentTarget;c(A.scrollTop)};return a.addEventListener("scroll",p),()=>a.removeEventListener("scroll",p)},[]);const k=n.useMemo(()=>({items:t.visibleItems,offsetY:t.offsetY,endIndex:t.visibleRange.end}),[t.visibleItems,t.offsetY,t.visibleRange.end]);return!i.length||!l.length?e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow p-8 text-center text-gray-500",children:"No therapists or clients available to display in the matrix."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:117,columnNumber:7},this):e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow overflow-hidden",children:[e.jsxDEV("div",{className:"grid grid-cols-[150px_1fr] divide-x divide-gray-200 dark:divide-gray-700",children:[e.jsxDEV("div",{className:"sticky top-0 z-10 bg-white dark:bg-dark-lighter",children:e.jsxDEV("div",{className:"h-12 flex items-center justify-center font-medium text-gray-700 dark:text-gray-300 border-b dark:border-gray-700",children:"Time"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:128,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:127,columnNumber:9},this),e.jsxDEV("div",{className:"sticky top-0 z-10 bg-white dark:bg-dark-lighter",children:e.jsxDEV("div",{className:"grid grid-cols-2 h-12 border-b dark:border-gray-700",children:[e.jsxDEV("div",{className:"flex items-center justify-center font-medium text-gray-700 dark:text-gray-300 border-r dark:border-gray-700",children:["Therapists (",i.length,")"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:136,columnNumber:13},this),e.jsxDEV("div",{className:"flex items-center justify-center font-medium text-gray-700 dark:text-gray-300",children:["Clients (",l.length,")"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:139,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:135,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:134,columnNumber:9},this),e.jsxDEV("div",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxDEV("div",{ref:f,className:"overflow-y-auto",style:{height:Ve},onScroll:t.onScroll,children:[e.jsxDEV("div",{style:{height:k.offsetY}},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:154,columnNumber:13},this),k.items.map(a=>e.jsxDEV("div",{className:"flex items-center justify-center text-sm text-gray-500 dark:text-gray-400 border-b dark:border-gray-700",style:{height:xe},children:a},a,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:158,columnNumber:15},this)),e.jsxDEV("div",{style:{height:(u.length-k.endIndex)*xe}},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:168,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:147,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:146,columnNumber:9},this),e.jsxDEV("div",{className:"relative",children:e.jsxDEV("div",{className:"overflow-y-auto",style:{height:Ve},onScroll:t.onScroll,children:[e.jsxDEV("div",{style:{height:k.offsetY}},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:178,columnNumber:13},this),k.items.map(a=>e.jsxDEV("div",{className:"grid grid-cols-2 border-b dark:border-gray-700",style:{height:xe},children:[e.jsxDEV("div",{className:"grid",style:{gridTemplateColumns:`repeat(${i.length}, 1fr)`},children:i.map(p=>{const N=g.get(a)?.therapists.has(p.id),A=parseInt(a.split(":")[0])>=8&&parseInt(a.split(":")[0])<=9||parseInt(a.split(":")[0])>=16&&parseInt(a.split(":")[0])<=18;return e.jsxDEV("button",{type:"button",className:`h-full border-r dark:border-gray-700 transition-colors relative ${N?"bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 cursor-pointer":"bg-red-50 dark:bg-red-900/20"}`,onClick:()=>{N&&r(a)},disabled:!N,"aria-label":`${p.full_name} availability at ${a}`,title:`${p.full_name} - ${a}`,children:[A&&p.avoid_rush_hour&&e.jsxDEV("div",{className:"absolute top-1 right-1",children:e.jsxDEV(Ae,{className:"w-3 h-3 text-amber-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:210,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:209,columnNumber:27},this),N&&e.jsxDEV("div",{className:"absolute bottom-1 right-1 text-xs opacity-0 group-hover:opacity-100",children:e.jsxDEV(le,{className:"w-3 h-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:215,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:214,columnNumber:27},this)]},`${a}-${p.id}`,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:191,columnNumber:23},this)})},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:184,columnNumber:17},this),e.jsxDEV("div",{className:"grid",style:{gridTemplateColumns:`repeat(${l.length}, 1fr)`},children:l.map(p=>{const N=g.get(a)?.clients.has(p.id),A=parseInt(a.split(":")[0])>=8&&parseInt(a.split(":")[0])<=9||parseInt(a.split(":")[0])>=16&&parseInt(a.split(":")[0])<=18;return e.jsxDEV("button",{type:"button",className:`h-full border-r dark:border-gray-700 transition-colors relative ${N?"bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 cursor-pointer":"bg-gray-50 dark:bg-gray-800"}`,onClick:()=>{N&&r(a)},disabled:!N,"aria-label":`${p.full_name} availability at ${a}`,title:`${p.full_name} - ${a}`,children:[A&&p.avoid_rush_hour&&e.jsxDEV("div",{className:"absolute top-1 right-1",children:e.jsxDEV(Ae,{className:"w-3 h-3 text-amber-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:250,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:249,columnNumber:27},this),N&&e.jsxDEV("div",{className:"absolute bottom-1 right-1 text-xs opacity-0 group-hover:opacity-100",children:e.jsxDEV(le,{className:"w-3 h-3 text-gray-500"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:255,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:254,columnNumber:27},this)]},`${a}-${p.id}`,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:231,columnNumber:23},this)})},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:224,columnNumber:17},this)]},a,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:182,columnNumber:15},this)),e.jsxDEV("div",{style:{height:(u.length-k.endIndex)*xe}},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:266,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:176,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:175,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:125,columnNumber:7},this),e.jsxDEV("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border-t dark:border-gray-700",children:e.jsxDEV("div",{className:"flex flex-wrap items-center gap-6 text-sm",children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-4 h-4 bg-green-50 dark:bg-green-900/20 border border-gray-200 dark:border-gray-700 rounded mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:277,columnNumber:13},this),e.jsxDEV("span",{className:"text-gray-600 dark:text-gray-300",children:"Therapist Available"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:278,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:276,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-4 h-4 bg-blue-50 dark:bg-blue-900/20 border border-gray-200 dark:border-gray-700 rounded mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:281,columnNumber:13},this),e.jsxDEV("span",{className:"text-gray-600 dark:text-gray-300",children:"Client Available"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:282,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:280,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-4 h-4 bg-red-50 dark:bg-red-900/20 border border-gray-200 dark:border-gray-700 rounded mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:285,columnNumber:13},this),e.jsxDEV("span",{className:"text-gray-600 dark:text-gray-300",children:"Therapist Unavailable"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:286,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:284,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-4 h-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:289,columnNumber:13},this),e.jsxDEV("span",{className:"text-gray-600 dark:text-gray-300",children:"Client Unavailable"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:290,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:288,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(Ae,{className:"w-4 h-4 text-amber-500 mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:293,columnNumber:13},this),e.jsxDEV("span",{className:"text-gray-600 dark:text-gray-300",children:"Rush Hour Warning"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:294,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:292,columnNumber:11},this),e.jsxDEV("div",{className:"flex items-center text-xs text-gray-500",children:e.jsxDEV("span",{children:["Virtual scrolling active - rendering ",k.items.length," of ",u.length," time slots"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:297,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:296,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:275,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:274,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/components/SchedulingMatrix.tsx",lineNumber:124,columnNumber:5},this)}if(typeof window<"u"&&typeof document<"u"){const i=l=>{try{const b=l.detail||{};localStorage.setItem("pendingSchedule",JSON.stringify(b))}catch{}};document.addEventListener("openScheduleModal",i,!0),window.addEventListener("openScheduleModal",i,!0)}const qs=300,we=i=>{if(!i||typeof i!="object")return null;const b=i.start_time;return b!==void 0&&typeof b!="string"?null:{start_time:typeof b=="string"?b:void 0}};function Je(i,l){if(typeof i!="string")return;const b=i.trim();if(b.length!==0)try{if(/[zZ]|[+-]\d{2}:?\d{2}$/.test(b)){const f=new Date(b);return Number.isNaN(f.getTime())?void 0:f.toISOString()}return be(b,l).toISOString()}catch(r){J.warn("Failed to normalize recurrence datetime",{metadata:{value:i,timeZone:l,failure:he(r,"Recurrence normalization failed").message}});return}}function Ws(i){if(!i?.enabled)return;const l=i.rule.trim();if(l.length===0)return;const b={rule:l,timeZone:i.timeZone};typeof i.count=="number"&&Number.isFinite(i.count)&&i.count>0&&(b.count=Math.trunc(i.count));const r=Je(i.until,i.timeZone);r&&(b.until=r);const f=i.exceptions.map(o=>Je(o,i.timeZone)).filter(o=>typeof o=="string");return f.length>0&&(b.exceptions=f),b}const Fe=ke.memo(({time:i,day:l,sessions:b,onCreateSession:r,onEditSession:f})=>{const o=n.useCallback(()=>{r({date:l,time:i})},[l,i,r]),c=n.useCallback((t,x)=>{t.stopPropagation(),f(x)},[f]),u=n.useMemo(()=>{const t=y(l,"yyyy-MM-dd");return b.filter(x=>{const g=x.start_time,k=y(I(g),"yyyy-MM-dd"),a=y(I(g),"HH:mm"),p=typeof g=="string"&&g.length>=10?g.slice(0,10):void 0,N=typeof g=="string"&&g.length>=16?g.slice(11,16):void 0;return(k===t||p===t)&&(a===i||N===i)})},[b,l,i]);return e.jsxDEV("div",{className:"h-10 border-b dark:border-gray-700 border-r dark:border-gray-700 p-2 relative group cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",role:"button",tabIndex:0,onClick:o,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&o(t)},children:[e.jsxDEV("button",{"aria-label":"Add session",title:"Add session",className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-opacity",children:e.jsxDEV(ys,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:206,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:205,columnNumber:9},void 0),u.map(t=>e.jsxDEV("div",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded p-1 text-xs mb-1 group/session relative cursor-pointer hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",role:"button",tabIndex:0,onClick:x=>c(x,t),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&c(x,t)},children:[e.jsxDEV("div",{className:"font-medium truncate",children:t.client?.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:220,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-blue-600 dark:text-blue-300 truncate",children:t.therapist?.full_name},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:223,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center text-blue-500 dark:text-blue-400",children:[e.jsxDEV(le,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:227,columnNumber:15},void 0),y(I(t.start_time),"h:mm a")]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:226,columnNumber:13},void 0),e.jsxDEV("div",{className:"absolute top-1 right-1 opacity-0 group-hover/session:opacity-100 flex space-x-1",children:e.jsxDEV("button",{className:"p-1 rounded hover:bg-blue-300 dark:hover:bg-blue-800",onClick:x=>{x.stopPropagation(),f(t)},"aria-label":"Edit session",title:"Edit session",children:e.jsxDEV(As,{className:"w-3 h-3"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:240,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:232,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:231,columnNumber:13},void 0)]},t.id,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:210,columnNumber:11},void 0))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:196,columnNumber:7},void 0)});Fe.displayName="TimeSlot";function Ks(){if(typeof crypto<"u"&&typeof crypto.randomUUID=="function")try{return crypto.randomUUID()}catch(i){J.warn("Failed to generate idempotency key",{metadata:{failure:he(i,"Idempotency key generation failed").message}})}}async function _e(i){const l=Ks(),b={"Content-Type":"application/json"};l&&(b["Idempotency-Key"]=l);const{data:{session:r}}=await _s.auth.getSession(),f=r?.access_token?.trim();if(!f)throw new Error("Authentication is required to book sessions");b.Authorization=`Bearer ${f}`;let o;try{o=await fetch("/api/book",{method:"POST",headers:b,body:JSON.stringify(i)})}catch(u){throw J.error("Booking API request failed",{error:he(u,"Booking API request failed"),metadata:{endpoint:"/api/book"}}),new Error("Unable to reach booking service")}let c=null;try{c=await o.json()}catch(u){J.error("Failed to parse booking API response",{error:he(u,"Booking API response parsing failed"),metadata:{endpoint:"/api/book"}})}if(!o.ok||!c){const u=c?.error??"Failed to book session",t=new Error(u);throw t.status=o.status,o.status===409&&(t.retryHint=typeof c?.hint=="string"&&c.hint.length>0?c.hint:"The selected slot was just taken. Refresh the schedule or choose a different time."),t}if(!c.success||!c.data)throw new Error(c.error??"Failed to book session");return c.data}function Te(i,l,b){const r={...i,status:i.status??"scheduled"},f=Ws(b)??i.recurrence??void 0;return{session:r,startTimeOffsetMinutes:l.startOffsetMinutes,endTimeOffsetMinutes:l.endOffsetMinutes,timeZone:l.timeZone,holdSeconds:qs,...f?{recurrence:f}:{}}}const ns=ke.memo(({day:i,timeSlots:l,sessions:b,onCreateSession:r,onEditSession:f,showAvailability:o,therapists:c,clients:u})=>e.jsxDEV("div",{className:"relative",children:[o&&e.jsxDEV(is,{therapists:c,clients:u,selectedDate:i,timeSlots:l},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:389,columnNumber:11},void 0),l.map(t=>e.jsxDEV(Fe,{time:t,day:i,sessions:b,onCreateSession:r,onEditSession:f},t,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:398,columnNumber:11},void 0))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:387,columnNumber:7},void 0));ns.displayName="DayColumn";const rs=ke.memo(({weekDays:i,timeSlots:l,sessions:b,onCreateSession:r,onEditSession:f,showAvailability:o,therapists:c,clients:u})=>e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow overflow-x-auto",children:[e.jsxDEV("div",{className:"grid grid-cols-7 border-b dark:border-gray-700 min-w-[800px]",children:[e.jsxDEV("div",{className:"py-2 px-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400 border-r dark:border-gray-700",children:"Time"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:438,columnNumber:11},void 0),i.map(t=>e.jsxDEV("div",{className:"py-2 px-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:y(t,"EEE MMM d")},t.toISOString(),!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:442,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:437,columnNumber:9},void 0),e.jsxDEV("div",{className:"grid grid-cols-7 min-w-[800px]",children:[e.jsxDEV("div",{className:"border-r dark:border-gray-700",children:l.map(t=>e.jsxDEV("div",{className:"h-10 border-b dark:border-gray-700 p-2 text-sm text-gray-500 dark:text-gray-400 flex items-center",children:t},t,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:454,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:452,columnNumber:11},void 0),i.map(t=>e.jsxDEV(ns,{day:t,timeSlots:l,sessions:b,onCreateSession:r,onEditSession:f,showAvailability:o,therapists:c,clients:u},t.toISOString(),!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:464,columnNumber:13},void 0))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:451,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:436,columnNumber:7},void 0));rs.displayName="WeekView";const ls=ke.memo(({selectedDate:i,timeSlots:l,sessions:b,onCreateSession:r,onEditSession:f,showAvailability:o,therapists:c,clients:u})=>e.jsxDEV("div",{className:"bg-white dark:bg-dark-lighter rounded-lg shadow overflow-x-auto","data-testid":"day-view",children:[e.jsxDEV("div",{className:"grid grid-cols-2 border-b dark:border-gray-700",children:[e.jsxDEV("div",{className:"py-4 px-2 text-center text-sm font-medium text-gray-500 dark:text-gray-400 border-r dark:border-gray-700",children:"Time"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:511,columnNumber:11},void 0),e.jsxDEV("div",{className:"py-4 px-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:y(i,"EEEE, MMMM d, yyyy")},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:514,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:510,columnNumber:9},void 0),e.jsxDEV("div",{className:"grid grid-cols-2",children:[e.jsxDEV("div",{className:"border-r dark:border-gray-700",children:l.map(t=>e.jsxDEV("div",{className:"h-10 border-b dark:border-gray-700 p-2 text-sm text-gray-500 dark:text-gray-400 flex items-center",children:t},t,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:522,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:520,columnNumber:11},void 0),e.jsxDEV("div",{className:"relative",children:[o&&e.jsxDEV(is,{therapists:c,clients:u,selectedDate:i,timeSlots:l},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:533,columnNumber:15},void 0),l.map(t=>e.jsxDEV(Fe,{time:t,day:i,sessions:b,onCreateSession:r,onEditSession:f},t,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:542,columnNumber:15},void 0))]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:531,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:519,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:506,columnNumber:7},void 0));ls.displayName="DayView";const Bs=ke.memo(()=>{const{user:i,profile:l}=Us(),b=$s(),[r,f]=n.useState(new Date),[o,c]=n.useState("week"),[u,t]=n.useState(!1),[x,g]=n.useState(!1),[k,a]=n.useState(),[p,N]=n.useState(),[A,$]=n.useState(!0),[j,V]=n.useState(null),[O,w]=n.useState(null),[K,B]=n.useState(null),[m,C]=n.useState(null),[S,T]=n.useState(null),v=ks(),E=n.useCallback(s=>{const d=he(s,"Schedule mutation failed");if((typeof s?.status=="number"?s.status:void 0)===409){const M=s?.retryHint,Z=typeof M=="string"&&M.length>0?M:"The selected time slot was just booked. Refresh the schedule or choose a different time.";J.warn("Schedule mutation conflict",{metadata:{hint:Z,error:d.message}}),T(Z),Me(`${d.message}. ${Z}`);return}T(null),Me(d)},[]),_=n.useMemo(()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone??"UTC"}catch(s){return J.warn("Unable to resolve timezone for schedule view",{metadata:{fallback:"UTC",failure:he(s,"Timezone resolution failed").message}}),"UTC"}},[]),[ie,z]=n.useState(!1),[ee,R]=n.useState("FREQ=WEEKLY;INTERVAL=1"),[L,ce]=n.useState(),[oe,Ne]=n.useState(""),[de,ue]=n.useState([]),[fe,h]=n.useState(_);n.useLayoutEffect(()=>{h(_);try{window.__enableOpenScheduleCapture=!0}catch{}const s=setTimeout(()=>{try{window.__enableOpenScheduleCapture=!1}catch{}},6e3);return()=>{clearTimeout(s);try{window.__enableOpenScheduleCapture=!1}catch{}}},[_]),n.useLayoutEffect(()=>{k&&z(!1)},[k]);const U=n.useMemo(()=>({enabled:ie,rule:ee,count:L,until:oe,exceptions:de,timeZone:fe}),[ie,ee,L,oe,de,fe]),P=n.useCallback(s=>{if(!s.start_time||!s.end_time)throw new Error("Missing session start or end time");const d=I(s.start_time),D=I(s.end_time);if(Number.isNaN(d.getTime())||Number.isNaN(D.getTime()))throw new Error("Invalid session time provided");const M=Math.round(Be(_,d)/6e4),Z=Math.round(Be(_,D)/6e4);return{startTime:s.start_time,endTime:s.end_time,startOffsetMinutes:M,endOffsetMinutes:Z,timeZone:_}},[_]);n.useLayoutEffect(()=>{const s=localStorage.getItem("pendingSchedule");if(s){let q=null;try{q=we(JSON.parse(s))}catch{}finally{localStorage.removeItem("pendingSchedule")}q&&setTimeout(()=>{try{if(q?.start_time){const G=I(q.start_time);f(G),N({date:G,time:y(G,"HH:mm")})}a(void 0),t(!0)}catch{}},300)}let d=!1;const D=window.setInterval(()=>{if(d)return;const q=localStorage.getItem("pendingSchedule");q&&(localStorage.removeItem("pendingSchedule"),d=!0,setTimeout(()=>{try{const G=we(JSON.parse(q));if(G?.start_time){const te=I(G.start_time);f(te),N({date:te,time:y(te,"HH:mm")})}a(void 0),t(!0)}catch{}},300))},100),M=()=>window.clearInterval(D),Z=window.setTimeout(M,6500),W=q=>{const G=we(q.detail);if(G?.start_time){const te=I(G.start_time);f(te),N({date:te,time:y(te,"HH:mm")})}a(void 0),t(!0)};return document.addEventListener("openScheduleModal",W,!0),window.addEventListener("openScheduleModal",W,!0),document.addEventListener("openScheduleModal",W),window.addEventListener("openScheduleModal",W),()=>{M(),window.clearTimeout(Z),document.removeEventListener("openScheduleModal",W,!0),window.removeEventListener("openScheduleModal",W,!0),document.removeEventListener("openScheduleModal",W),window.removeEventListener("openScheduleModal",W)}},[]);const H=n.useMemo(()=>Es(r,{weekStartsOn:1}),[r]),ae=n.useMemo(()=>Is(r,{weekStartsOn:1}),[r]),X=Qe(j,300),Q=Qe(O,300),{data:se,isLoading:ge}=Ms(H,ae),{data:ne=[],isLoading:me}=Vs(H,ae,X,Q),{data:Y,isLoading:Ee}=ws(),F={sessions:se?.sessions||ne,therapists:se?.therapists||Y?.therapists||[],clients:se?.clients||Y?.clients||[]};n.useEffect(()=>{if(j||l?.role!=="therapist")return;const s=i?.user_metadata??{},d=new Set;typeof l?.id=="string"&&d.add(l.id);const D=typeof s.therapist_id=="string"?s.therapist_id.trim():null;D&&d.add(D);const M=typeof s.therapistId=="string"?s.therapistId.trim():null;M&&d.add(M);const Z=l?.preferences;if(Z&&typeof Z=="object"){const q=Z,G=typeof q.therapist_id=="string"?q.therapist_id.trim():null;G&&d.add(G);const te=typeof q.therapistId=="string"?q.therapistId.trim():null;te&&d.add(te)}const W=F.therapists.find(q=>d.has(q.id));W&&(V(W.id),B(W.id))},[j,l?.role,l?.id,l?.preferences,i,F.therapists]),n.useEffect(()=>{j&&!F.therapists.some(s=>s.id===j)&&V(null)},[j,F.therapists]),n.useEffect(()=>{O&&!F.clients.some(s=>s.id===O)&&w(null)},[O,F.clients]);const os=n.useCallback(s=>{V(s),s!==K&&B(null)},[K]),as=n.useCallback(s=>{w(s),s!==m&&C(null)},[m]),Oe=ye({mutationFn:async s=>{if(!s.therapist_id||!s.client_id||!s.start_time||!s.end_time)throw new Error("Missing required session details");const{startOffsetMinutes:d,endOffsetMinutes:D,timeZone:M}=P(s);return(await _e({...Te(s,{startOffsetMinutes:d,endOffsetMinutes:D,timeZone:M},U),overrides:void 0})).session},onSuccess:()=>{v.invalidateQueries({queryKey:["sessions"]}),v.invalidateQueries({queryKey:["sessions-batch"]}),t(!1),a(void 0),N(void 0),T(null)},onError:s=>{E(s)}}),$e=ye({mutationFn:async s=>{const d=[];for(const D of s){if(!D.therapist_id||!D.client_id||!D.start_time||!D.end_time)throw new Error("Missing required session details");const{startOffsetMinutes:M,endOffsetMinutes:Z,timeZone:W}=P(D),q=await _e({...Te(D,{startOffsetMinutes:M,endOffsetMinutes:Z,timeZone:W}),overrides:void 0});d.push(q.session)}return d},onSuccess:()=>{v.invalidateQueries({queryKey:["sessions"]}),v.invalidateQueries({queryKey:["sessions-batch"]}),g(!1),T(null)},onError:s=>{E(s)}}),He=ye({mutationFn:async s=>{if(!k)throw new Error("No session selected for update");const d={...k,...s};if(!d.therapist_id||!d.client_id||!d.start_time||!d.end_time)throw new Error("Missing required session details");const{startOffsetMinutes:D,endOffsetMinutes:M,timeZone:Z}=P(d);return(await _e({...Te({...d,id:k.id},{startOffsetMinutes:D,endOffsetMinutes:M,timeZone:Z},U),overrides:void 0})).session},onSuccess:()=>{v.invalidateQueries({queryKey:["sessions"]}),v.invalidateQueries({queryKey:["sessions-batch"]}),t(!1),a(void 0),T(null)},onError:s=>{E(s)}}),De=ye({mutationFn:async({sessionId:s,reason:d})=>await Os({sessionIds:[s],reason:d}),onSuccess:()=>{v.invalidateQueries({queryKey:["sessions"]}),v.invalidateQueries({queryKey:["sessions-batch"]})},onError:s=>{Me(s)}}),Ie=n.useCallback(s=>{T(null),N(s),a(void 0),t(!0)},[]),Re=n.useCallback(s=>{T(null),a(s),N(void 0),t(!0)},[]),ms=n.useCallback(()=>{ue(s=>[...s,""])},[]),cs=n.useCallback((s,d)=>{ue(D=>{const M=[...D];return M[s]=d,M})},[]),ds=n.useCallback(s=>{ue(d=>d.filter((D,M)=>M!==s))},[]),Le=n.useCallback(()=>{t(!1),T(null)},[]),Pe=n.useCallback(()=>{T(null)},[]);n.useCallback(async s=>{if(window.confirm("Are you sure you want to cancel this session?")){const d=await De.mutateAsync({sessionId:s});Ye(d.cancelledCount>0?"Session cancelled successfully":"Session was already cancelled")}},[De]);const ze=n.useCallback(async s=>{if(k){if(s.status==="cancelled"){const d=typeof s.notes=="string"&&s.notes.trim().length>0?s.notes:void 0,D=await De.mutateAsync({sessionId:k.id,reason:d});Ye(D.cancelledCount>0?"Session cancelled successfully":"Session was already cancelled"),t(!1),a(void 0);return}await He.mutateAsync(s)}else await Oe.mutateAsync(s)},[k,De,He,Oe]),us=n.useCallback(async s=>{await $e.mutateAsync(s)},[$e]),Ze=n.useCallback(s=>{f(d=>{const D=o==="day"?1:7;return Se(d,s==="prev"?-D:D)})},[o]),je=n.useCallback(s=>{c(s)},[]),ps=n.useCallback(()=>{$(s=>!s)},[]),qe=n.useMemo(()=>{const s=[];for(let d=8;d<18;d++)for(let D=0;D<60;D+=15){const M=d.toString().padStart(2,"0"),Z=D.toString().padStart(2,"0");s.push(`${M}:${Z}`)}return s},[]),bs=n.useMemo(()=>Array.from({length:6},(s,d)=>Se(H,d)),[H]),hs=n.useMemo(()=>o==="day"?y(r,"MMMM d, yyyy"):`${y(H,"MMM d")} - ${y(Se(H,5),"MMM d, yyyy")}`,[H,r,o]);if(ge||me||Ee){const s={sessions:se?.sessions||ne,therapists:se?.therapists||Y?.therapists||[],clients:se?.clients||Y?.clients||[]};return e.jsxDEV("div",{className:"h-full relative",children:[e.jsxDEV("div",{className:"h-full flex items-center justify-center",children:e.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1232,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1231,columnNumber:9},void 0),u&&e.jsxDEV(Ge,{isOpen:u,onClose:Le,onSubmit:ze,session:k,selectedDate:p?.date,selectedTime:p?.time,therapists:s.therapists,clients:s.clients,existingSessions:s.sessions,timeZone:_,defaultTherapistId:j,defaultClientId:O,retryHint:S,onRetryHintDismiss:Pe},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1235,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1230,columnNumber:7},void 0)}return e.jsxDEV("div",{className:"h-full",children:[!b&&e.jsxDEV("div",{className:"mb-6 rounded-lg border border-amber-200 dark:border-amber-900/40 bg-amber-50 dark:bg-amber-900/20 px-4 py-3 text-amber-800 dark:text-amber-100",children:[e.jsxDEV("p",{className:"font-medium",children:"Organization context unavailable"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1260,columnNumber:11},void 0),e.jsxDEV("p",{className:"mt-1 text-sm opacity-80",children:"The schedule is scoped per organization. Impersonate a tenant or contact an administrator before booking sessions."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1261,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1259,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[e.jsxDEV("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Schedule"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1267,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center space-x-4",children:[e.jsxDEV("button",{onClick:()=>g(!0),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 flex items-center transition-colors",children:[e.jsxDEV(Ds,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1276,columnNumber:13},void 0),"Auto Schedule"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1272,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV("button",{"aria-label":"Previous period",onClick:()=>Ze("prev"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:e.jsxDEV(ss,{"aria-hidden":"true",className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1286,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1281,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(Ce,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1290,columnNumber:15},void 0),e.jsxDEV("span",{className:"font-medium text-gray-900 dark:text-white min-w-[200px] text-center",children:hs},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1291,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1289,columnNumber:13},void 0),e.jsxDEV("button",{"aria-label":"Next period",onClick:()=>Ze("next"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:e.jsxDEV(ts,{"aria-hidden":"true",className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1301,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1296,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1280,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex rounded-lg shadow-sm",children:[e.jsxDEV("button",{onClick:()=>je("day"),className:`px-4 py-2 text-sm font-medium transition-colors ${o==="day"?"bg-blue-600 text-white":"bg-white dark:bg-dark-lighter text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"} border border-gray-300 dark:border-gray-600 rounded-l-lg`,"aria-label":"Day view",children:"Day"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1306,columnNumber:13},void 0),e.jsxDEV("button",{onClick:()=>je("week"),className:`px-4 py-2 text-sm font-medium transition-colors ${o==="week"?"bg-blue-600 text-white":"bg-white dark:bg-dark-lighter text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"} border-t border-b border-gray-300 dark:border-gray-600`,"aria-label":"Week view",children:"Week"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1317,columnNumber:13},void 0),e.jsxDEV("button",{onClick:()=>je("matrix"),className:`px-4 py-2 text-sm font-medium transition-colors ${o==="matrix"?"bg-blue-600 text-white":"bg-white dark:bg-dark-lighter text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"} border border-gray-300 dark:border-gray-600 rounded-r-lg`,"aria-label":"Matrix view",children:"Matrix"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1328,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1305,columnNumber:11},void 0),e.jsxDEV("button",{onClick:ps,className:`px-4 py-2 text-sm font-medium transition-colors ${A?"bg-green-600 text-white":"bg-white dark:bg-dark-lighter text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"} border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm`,children:"Show Availability"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1341,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1271,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1266,columnNumber:7},void 0),e.jsxDEV(zs,{therapists:F.therapists,clients:F.clients,selectedTherapist:j,selectedClient:O,onTherapistChange:os,onClientChange:as,scopedTherapistId:K,scopedClientId:m},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1354,columnNumber:7},void 0),e.jsxDEV("div",{className:"mt-6 bg-white dark:bg-dark-lighter border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-4",children:[e.jsxDEV("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxDEV("label",{className:"inline-flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsxDEV("input",{type:"checkbox",className:"mr-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:ie,onChange:s=>z(s.target.checked)},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1368,columnNumber:13},void 0),"Enable recurrence (RRULE)"]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1367,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[e.jsxDEV("label",{htmlFor:"recurrence-timezone",className:"text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"Time Zone"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1378,columnNumber:13},void 0),e.jsxDEV("input",{id:"recurrence-timezone",type:"text",value:fe,onChange:s=>h(s.target.value),placeholder:"America/New_York",className:"flex-1 md:flex-none md:w-64 rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1381,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1377,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1366,columnNumber:9},void 0),ie&&e.jsxDEV("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"md:col-span-2",children:[e.jsxDEV("label",{htmlFor:"recurrence-rrule",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"RRULE"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1395,columnNumber:15},void 0),e.jsxDEV("input",{id:"recurrence-rrule",type:"text",value:ee,onChange:s=>R(s.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200",placeholder:"FREQ=WEEKLY;BYDAY=MO,WE;INTERVAL=1"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1398,columnNumber:15},void 0),e.jsxDEV("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Provide a valid RFC 5545 RRULE string. Weekly rules support automatic timezone-aware scheduling."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1406,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1394,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"recurrence-count",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Count"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1412,columnNumber:15},void 0),e.jsxDEV("input",{id:"recurrence-count",type:"number",min:"1",value:typeof L=="number"?L:"",onChange:s=>{const{value:d}=s.target;if(d.trim().length===0){ce(void 0);return}const D=Number(d);ce(Number.isNaN(D)?void 0:D)},className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1415,columnNumber:15},void 0),e.jsxDEV("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Limit the number of occurrences. Leave blank to rely on the RRULE or end date."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1432,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1411,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("label",{htmlFor:"recurrence-until",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Until"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1438,columnNumber:15},void 0),e.jsxDEV("input",{id:"recurrence-until",type:"datetime-local",value:oe,onChange:s=>Ne(s.target.value),className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1441,columnNumber:15},void 0),e.jsxDEV("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Optional end date in the selected time zone."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1448,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1437,columnNumber:13},void 0),e.jsxDEV("div",{className:"md:col-span-2",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[e.jsxDEV("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Exceptions"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1455,columnNumber:17},void 0),e.jsxDEV("button",{type:"button",onClick:ms,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 focus:outline-none",children:"Add exception"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1458,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1454,columnNumber:15},void 0),de.length===0?e.jsxDEV("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No exception dates configured."},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1468,columnNumber:17},void 0):e.jsxDEV("div",{className:"space-y-2",children:de.map((s,d)=>e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("input",{type:"datetime-local",value:s,onChange:D=>cs(d,D.target.value),className:"flex-1 rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-dark shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:text-gray-200"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1475,columnNumber:23},void 0),e.jsxDEV("button",{type:"button",onClick:()=>ds(d),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-red-600 hover:text-red-700 focus:outline-none",children:"Remove"},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1481,columnNumber:23},void 0)]},`recurrence-exception-${d}`,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1474,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1472,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1453,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1393,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1365,columnNumber:7},void 0),o==="matrix"?e.jsxDEV(Zs,{therapists:F.therapists,clients:F.clients,selectedDate:r,onTimeSlotClick:s=>Ie({date:r,time:s})},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1498,columnNumber:9},void 0):o==="day"?e.jsxDEV(ls,{selectedDate:r,timeSlots:qe,sessions:F.sessions.filter(s=>{const d=y(I(s.start_time),"yyyy-MM-dd"),D=typeof s.start_time=="string"&&s.start_time.length>=10?s.start_time.slice(0,10):void 0,M=y(r,"yyyy-MM-dd");return d===M||D===M}),onCreateSession:Ie,onEditSession:Re,showAvailability:A,therapists:F.therapists,clients:F.clients},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1507,columnNumber:9},void 0):e.jsxDEV(rs,{weekDays:bs,timeSlots:qe,sessions:F.sessions,onCreateSession:Ie,onEditSession:Re,showAvailability:A,therapists:F.therapists,clients:F.clients},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1525,columnNumber:9},void 0),u&&e.jsxDEV(Ge,{isOpen:u,onClose:Le,onSubmit:ze,session:k,selectedDate:p?.date,selectedTime:p?.time,therapists:F.therapists,clients:F.clients,existingSessions:F.sessions,timeZone:_,defaultTherapistId:j,defaultClientId:O,retryHint:S,onRetryHintDismiss:Pe},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1538,columnNumber:9},void 0),x&&e.jsxDEV(Ps,{isOpen:x,onClose:()=>g(!1),onSchedule:us,therapists:F.therapists,clients:F.clients,existingSessions:F.sessions},void 0,!1,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1557,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/test/Desktop/AllIincompassing/src/pages/Schedule.tsx",lineNumber:1257,columnNumber:5},void 0)});Bs.displayName="Schedule";export{Bs as default};
