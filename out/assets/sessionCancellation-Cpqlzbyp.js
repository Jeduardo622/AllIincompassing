import{p}from"./reports-B0fjwS8-.js";function C(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,10)}`}function u(e){return Array.isArray(e)?e.map(s=>typeof s=="string"?s:typeof s=="number"||typeof s=="bigint"?String(s):"").filter(s=>s.length>0):[]}async function g(e){if((!e.sessionIds||e.sessionIds.length===0)&&!e.date)throw new Error("Must provide a session id list or date to cancel sessions");const s=(e.idempotencyKey??C()).trim(),d=new Headers({"Content-Type":"application/json"});s.length>0&&d.set("Idempotency-Key",s);const o={};e.sessionIds&&e.sessionIds.length>0&&(o.session_ids=e.sessionIds),e.date&&(o.date=e.date),e.therapistId&&(o.therapist_id=e.therapistId),e.reason!==void 0&&(o.reason=e.reason);const i=await p("sessions-cancel",{method:"POST",headers:d,body:JSON.stringify(o)});let t=null;try{t=await i.json()}catch(a){console.error("Failed to parse sessions-cancel response",a)}if(!t||t.success!==!0||!i.ok){const a=typeof t?.error=="string"?t.error:"Failed to cancel sessions";throw new Error(a)}const n=t.data??{},r=typeof n.cancelledCount=="number"?n.cancelledCount:Number(n.cancelled_count??0),c=typeof n.alreadyCancelledCount=="number"?n.alreadyCancelledCount:Number(n.already_cancelled_count??0),l=typeof n.totalCount=="number"?n.totalCount:Number(n.total_count??r+c),y=u(n.cancelledSessionIds??n.cancelled_session_ids),f=u(n.alreadyCancelledSessionIds??n.already_cancelled_session_ids),m=i.headers.get("Idempotency-Key")?.trim()||s;return{cancelledCount:Number.isNaN(r)?0:r,alreadyCancelledCount:Number.isNaN(c)?0:c,totalCount:Number.isNaN(l)?r+c:l,cancelledSessionIds:y,alreadyCancelledSessionIds:f,idempotencyKey:m}}export{g as c};
